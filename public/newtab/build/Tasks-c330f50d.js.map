{"version":3,"file":"Tasks-c330f50d.js","sources":["../../../src/newtab/components/Tasks.svelte"],"sourcesContent":["<script>\n\timport { currentId, activeId } from \"../../store.js\";\n\n\timport { dndzone } from \"svelte-dnd-action\";\n\timport { flip } from \"svelte/animate\";\n\n\timport { createPopperActions } from \"svelte-popperjs\";\n\tconst [popperRef, popperContent] = createPopperActions();\n\tconst popperOptions = {\n\t\tplacement: \"bottom-start\",\n\t\tmodifiers: [{ name: \"offset\", options: { offset: [0, 4] } }],\n\t};\n\n\t// -- Members -- \\\\\n\tlet showTooltip = false;\n\tlet viewDone = false;\n\tlet todo = [];\n\tlet done = [];\n\n\tlet dragDisabled = true;\n\tconst flipDurationMs = 300;\n\n\t// -- Initialization -- \\\\\n\tactiveId.subscribe((val) => {\n\t\tlet todoId = `todo-${val}`;\n\t\tlet doneId = `done-${val}`;\n\t\tchrome.storage.sync.get([todoId, doneId], function (result) {\n\t\t\ttodo = result[todoId] ?? [];\n\t\t\tdone = result[doneId] ?? [];\n\n\t\t\tsyncTodo();\n\t\t\tsyncDone();\n\t\t});\n\t});\n\n\t// -- Synchronization -- \\\\\n\tasync function syncTodo() {\n\t\ttry {\n\t\t\tchrome.storage.sync.set({ [`todo-${$activeId}`]: todo });\n\t\t\ttodo = todo;\n\t\t} catch (e) {\n\t\t\tconsole.error(e);\n\t\t}\n\t}\n\n\tasync function syncDone() {\n\t\ttry {\n\t\t\tchrome.storage.sync.set({ [`done-${$activeId}`]: done });\n\t\t\tdone = done;\n\t\t} catch (e) {\n\t\t\tconsole.error(e);\n\t\t}\n\t}\n\n\t// -- Functions -- \\\\\n\tasync function addTodo() {\n\t\ttodo.unshift({\n\t\t\tid: $currentId++,\n\t\t\ttitle: this.querySelector(\"input[type='text']\").value,\n\t\t\tdue: this.querySelector(\"input[type='date']\")?.value,\n\t\t});\n\n\t\tthis.reset();\n\t\tsyncTodo();\n\t}\n\n\tasync function markDone(item) {\n\t\tconst index = todo.indexOf(item);\n\t\tif (index > -1) {\n\t\t\tconst [item] = todo.splice(index, 1);\n\t\t\tdone.unshift({\n\t\t\t\tid: item.id,\n\t\t\t\ttitle: item.title,\n\t\t\t\tfinished: new Date().toISOString().slice(0, 10),\n\t\t\t});\n\n\t\t\tsyncTodo();\n\t\t\tsyncDone();\n\t\t}\n\t}\n\n\tasync function removeTodo(item) {\n\t\tconst index = todo.indexOf(item);\n\t\tif (index > -1) {\n\t\t\ttodo.splice(index, 1);\n\t\t}\n\n\t\tsyncTodo();\n\t}\n\n\tasync function removeDone(item) {\n\t\tconst index = done.indexOf(item);\n\t\tif (index > -1) {\n\t\t\tdone.splice(index, 1);\n\t\t}\n\n\t\tsyncDone();\n\t}\n\n\tfunction handleDndConsider(e) {\n\t\ttodo = e.detail.items;\n\t}\n\n\tfunction handleDndFinalize(e) {\n\t\ttodo = e.detail.items;\n\t\tif (e.detail.info.source == \"pointer\") {\n\t\t\tdragDisabled = true;\n\t\t}\n\t}\n\n\tfunction startDrag(e) {\n\t\t// preventing default to prevent lag on touch devices (because of the browser checking for screen scrolling)\n\t\te.preventDefault();\n\t\tdragDisabled = false;\n\t}\n</script>\n\n<article>\n\t<header>\n\t\t<form on:submit|preventDefault={addTodo}>\n\t\t\t<label>\n\t\t\t\t<input type=\"text\" placeholder=\"Write a new task\" required />\n\t\t\t\t<span>Write a new task</span>\n\t\t\t</label>\n\t\t\t<button\n\t\t\t\tclass=\"material-icons [ no-gutters ]\"\n\t\t\t\ttype=\"button\"\n\t\t\t\ttitle=\"Add due date\"\n\t\t\t\tuse:popperRef\n\t\t\t\ton:click={() => showTooltip = !showTooltip}\n\t\t\t>\n\t\t\t\tevent\n\t\t\t</button>\n\t\t\t{#if showTooltip}\n\t\t\t\t<div\n\t\t\t\t\tclass=\"tooltip [ surface elevation-24 ]\"\n\t\t\t\t\tuse:popperContent={popperOptions}\n\t\t\t\t>\n\t\t\t\t\t<input type=\"date\" />\n\t\t\t\t\t<div class=\"arrow\" data-popper-arrow />\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t\t<input type=\"submit\" hidden />\n\t\t</form>\n\t</header>\n\t<ul\n\t\tclass=\"todo-wrapper\"\n\t\tuse:dndzone={{\n\t\t\titems: todo,\n\t\t\tflipDurationMs,\n\t\t\tdragDisabled,\n\t\t\tdropTargetStyle: {},\n\t\t}}\n\t\ton:consider={handleDndConsider}\n\t\ton:finalize={handleDndFinalize}\n\t>\n\t\t{#if !viewDone}\n\t\t\t{#each todo as item (item.id)}\n\t\t\t\t<li class=\"todo-item\" animate:flip={{ duration: flipDurationMs }}>\n\t\t\t\t\t<div\n\t\t\t\t\t\taria-label=\"drag-handle\"\n\t\t\t\t\t\tclass=\"drag-handle material-icons md-18 [ hint no-gutters ]\"\n\t\t\t\t\t\tstyle={dragDisabled ? \"cursor: grab\" : \"cursor: grabbing\"}\n\t\t\t\t\t\ton:mousedown={startDrag}\n\t\t\t\t\t\ton:touchstart={startDrag}\n\t\t\t\t\t>\n\t\t\t\t\t\tdrag_indicator\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tclass=\"todo-item__title line-hover [ no-gutters ]\"\n\t\t\t\t\t\t\ttitle=\"Mark as done\"\n\t\t\t\t\t\t\ton:click={markDone(item)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{item.title}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t{#if item.due}\n\t\t\t\t\t\t\t<span class=\"todo-item__due [ hint ]\">\n\t\t\t\t\t\t\t\t<i class=\"material-icons md-12\">event</i>\n\t\t\t\t\t\t\t\t{item.due}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\t\t\t\t\t<button class=\"task-delete material-icons [ md-14 no-gutters ] [ alert ]\" title=\"Delete task\" on:click={removeTodo(item)}>\n\t\t\t\t\t\tclose\n\t\t\t\t\t</button>\n\t\t\t\t</li>\n\t\t\t{/each}\n\t\t{:else}\n\t\t\t{#each done as item (item.id)}\n\t\t\t\t<li class=\"todo-item\" animate:flip={{ duration: flipDurationMs }}>\n\t\t\t\t\t<div class=\"todo-item__body\">\n\t\t\t\t\t\t<span class=\"todo-item__title done\">{item.title}</span>\n\t\t\t\t\t\t<span class=\"todo-item__due [ hint ]\">\n\t\t\t\t\t\t\t<i class=\"material-icons md-12\">done</i>\n\t\t\t\t\t\t\t{item.finished}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<button class=\"task-delete material-icons [ md-14 no-gutters ] [ alert ]\" title=\"Delete task\" on:click={removeDone(item)}>\n\t\t\t\t\t\tclose\n\t\t\t\t\t</button>\n\t\t\t\t</li>\n\t\t\t{/each}\n\t\t{/if}\n\t</ul>\n\t<button class=\"task-actions\" on:click={() => (viewDone = !viewDone)}>\n\t\t{#if !viewDone}\n\t\t\t<i class=\"material-icons md-18\">checklist</i>\n\t\t\t<span>History</span>\n\t\t{:else}\n\t\t\t<i class=\"material-icons md-18\">list</i>\n\t\t\t<span>Tasks</span>\n\t\t{/if}\n\t</button>\n</article>\n\n<style>\n\tarticle {\n\t\theight: 100%;\n\t\tpadding: var(--space-4);\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tjustify-content: space-between;\n\t}\n\n\theader {\n\t\tmargin-bottom: var(--space-4);\n\t}\n\n\tform {\n\t\tflex-direction: row;\n\t\talign-items: flex-end;\n\t\tgap: var(--space-4);\n\t}\n\n\tlabel {\n\t\tflex: 1;\n\t}\n\n\tform input[type=\"text\"] {\n\t\twidth: 100%;\n\t}\n\n\t.todo-wrapper {\n\t\tmin-height: 0;\n\t\tflex: 1;\n\t\toverflow-y: auto;\n\t}\n\n\t.todo-wrapper:focus {\n\t\toutline: none;\n\t}\n\n\t.todo-item {\n\t\tposition: relative;\n\t\tpadding: var(--space-2) 0;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t}\n\n\t.todo-item__title {\n\t\tfont-size: 1rem;\n\t\tfont-weight: 400;\n\t}\n\n\t.todo-item__title:hover {\n\t\tfilter: brightness(125%);\n\t}\n\n\t.todo-item__due {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: var(--space-1);\n\n\t\tfont-size: 0.75rem;\n\t\tline-height: 16px;\n\t}\n\n\t.task-actions {\n\t\talign-self: center;\n\t}\n\n\t.drag-handle {\n\t\topacity: 0;\n\t\ttransition: opacity 0.25s ease-in-out;\n\t}\n\n\t.todo-item:hover > .drag-handle,\n\t.todo-item:hover > .task-delete {\n\t\topacity: 1;\n\t}\n\n\t.line-hover {\n\t\tbackground-image: linear-gradient(currentColor, currentColor);\n    background-position: 0% 50%;\n    background-repeat: no-repeat;\n    background-size: 0% 2px;\n    transition: background-size .3s;\n\t\tcursor: pointer;\n\t}\n\n\t.line-hover:hover {\n\t\tbackground-size: 100% 2px;\n\t}\n\n\t.done {\n\t\ttext-decoration: line-through;\n\t}\n\n\t.task-delete {\n\t\tposition: absolute;\n\t\tright: 0;\n\t\ttop: 50%;\n\t\ttransform: translateY(-50%);\n\t\topacity: 0;\n\t\ttransition: opacity 0.25s ease-in-out;\n\t}\n</style>\n"],"names":[],"mappings":"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"}